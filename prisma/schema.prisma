// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "postgresql"
}

// ============================================
// Authentication Models
// ============================================

enum UserRole {
  ADMIN
  EDITOR
  VIEWER
}

model User {
  id        String   @id @default(cuid())
  email     String   @unique
  password  String
  name      String
  role      UserRole @default(VIEWER)
  isActive  Boolean  @default(true)

  // Relations
  newsCreated     News[]     @relation("NewsAuthor")
  eventsCreated   Event[]    @relation("EventAuthor")
  activityCreated Activity[] @relation("ActivityAuthor")

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("users")
}

// ============================================
// Content Models
// ============================================

enum NewsStatus {
  DRAFT
  PUBLISHED
  ARCHIVED
}

model News {
  id          String      @id @default(cuid())
  title       String      @db.VarChar(255)
  slug        String      @unique @db.VarChar(255)
  description String      @db.Text
  content     String      @db.Text
  image       String?
  status      NewsStatus  @default(DRAFT)
  featured    Boolean     @default(false)
  views       Int         @default(0)

  // Relations
  authorId String
  author   User   @relation("NewsAuthor", fields: [authorId], references: [id], onDelete: Cascade)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([authorId])
  @@index([slug])
  @@index([status])
  @@map("news")
}

enum EventStatus {
  UPCOMING
  ONGOING
  COMPLETED
  CANCELLED
}

model Event {
  id          String      @id @default(cuid())
  title       String      @db.VarChar(255)
  slug        String      @unique @db.VarChar(255)
  description String      @db.Text
  content     String      @db.Text
  image       String?
  location    String?
  startDate   DateTime
  endDate     DateTime?
  status      EventStatus @default(UPCOMING)

  // Relations
  authorId String
  author   User   @relation("EventAuthor", fields: [authorId], references: [id], onDelete: Cascade)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([authorId])
  @@index([slug])
  @@index([status])
  @@index([startDate])
  @@map("events")
}

enum ActivityType {
  ACADEMIC
  EXTRACURRICULAR
  COMMUNITY
  OTHER
}

model Activity {
  id          String       @id @default(cuid())
  title       String       @db.VarChar(255)
  slug        String       @unique @db.VarChar(255)
  description String       @db.Text
  content     String       @db.Text
  image       String?
  type        ActivityType @default(ACADEMIC)
  institution String?      
  featured    Boolean      @default(false)

  // Relations
  authorId String
  author   User   @relation("ActivityAuthor", fields: [authorId], references: [id], onDelete: Cascade)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([authorId])
  @@index([slug])
  @@index([type])
  @@map("activities")
}

// ============================================
// Contact & Inquiry Models
// ============================================

enum InquiryStatus {
  NEW
  READ
  REPLIED
  CLOSED
}

model ContactInquiry {
  id        String         @id @default(cuid())
  name      String
  email     String
  phone     String?
  subject   String
  message   String         @db.Text
  status    InquiryStatus  @default(NEW)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([status])
  @@index([email])
  @@map("contact_inquiries")
}

model Registration {
  id          String   @id @default(cuid())
  parentName  String
  email       String
  phone       String
  studentName String
  age         Int
  institution String   
  message     String?  @db.Text

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([institution])
  @@index([email])
  @@map("registrations")
}
